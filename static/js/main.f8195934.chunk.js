(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{188:function(e,t,a){e.exports=a(392)},194:function(e,t,a){},392:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),r=a(8),s=a.n(r),u=(a(193),a(194),a(195),a(185)),i=(a(83),a(38)),o=(a(168),a(42)),c=(a(106),a(31)),d=(a(108),a(15)),h=(a(133),a(28)),p=(a(84),a(26)),m=(a(393),a(105)),y=(a(169),a(79)),f=a(37),v=(a(207),a(184)),b=a(27),g=a(41),E=a(53),O=a(52),k=a(18),j=a(54),w=(a(209),a(81)),B=a(39),I=a.n(B),H=a(170),x=a.n(H),V=a(130),C=a.n(V),N=a(171),S=a.n(N),q=(a(394),a(183)),R=(a(238),a(181)),A=(a(137),a(10)),T=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).changeInputValue=a.changeInputValue.bind(Object(k.a)(a)),a}return Object(j.a)(t,e),Object(g.a)(t,[{key:"changeInputValue",value:function(e){this.props.updateHandler(this.props.header.index,e.target.name,e.target.value)}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a.Group,{compact:!0,style:{width:"90%"}},l.a.createElement(p.a,{style:{width:"20%"},name:"key",value:this.props.header.key,onChange:this.changeInputValue,placeholder:"User-Agent"}),l.a.createElement(p.a,{style:{width:"80%"},name:"value",value:this.props.header.value,onChange:this.changeInputValue,placeholder:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"})),this.props.showDeleteButton?l.a.createElement(A.a,{className:"dynamic-delete-button color-red",type:"minus-circle-o",style:{color:"#ff6868"},onClick:function(t){return e.props.deleteHandler(e.props.header.index)}}):null,this.props.showAddButton?l.a.createElement(A.a,{className:"dynamic-delete-button color-grey",type:"plus-circle-o",onClick:this.props.addHandler}):null)}}]),t}(l.a.Component),z=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).changeInputValue=a.changeInputValue.bind(Object(k.a)(a)),a}return Object(j.a)(t,e),Object(g.a)(t,[{key:"changeInputValue",value:function(e){this.props.updateHandler(this.props.body.index,e.target.name,e.target.value)}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a.Group,{compact:!0,style:{width:"90%"}},l.a.createElement(p.a,{style:{width:"20%"},name:"key",value:this.props.body.key,onChange:this.changeInputValue,placeholder:"username"}),l.a.createElement(p.a,{style:{width:"80%"},name:"value",value:this.props.body.value,onChange:this.changeInputValue,placeholder:"zhangsan"})),this.props.showDeleteButton?l.a.createElement(A.a,{className:"dynamic-delete-button color-red",type:"minus-circle-o",style:{color:"#ff6868"},onClick:function(t){return e.props.deleteHandler(e.props.body.index)}}):null,this.props.showAddButton?l.a.createElement(A.a,{className:"dynamic-delete-button color-grey",type:"plus-circle-o",onClick:this.props.addHandler}):null)}}]),t}(l.a.Component),P=0,$=function e(){Object(b.a)(this,e),this.index=++P,this.key="",this.value=""},D=0,G=function e(){Object(b.a)(this,e),this.index=++D,this.key="",this.value=""};function K(e,t){for(var a in e)if(e[a].index===t)return a;return-1}var W=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).setIdentificationValue=function(e){a.setState({idenValue:e.target.value},function(){a.props.rule.setIdenValue(a.state.idenValue)})},a.idenValue="",a.state={pathHelp:{status:"success",help:""},headersHelp:{status:"success",help:""},bodysHelp:{status:"success",help:""}},a.changeInputValue=a.changeInputValue.bind(Object(k.a)(a)),a.changeInputValueByName=a.changeInputValueByName.bind(Object(k.a)(a)),a.addHeader=a.addHeader.bind(Object(k.a)(a)),a.updateHeader=a.updateHeader.bind(Object(k.a)(a)),a.deleteHeader=a.deleteHeader.bind(Object(k.a)(a)),a.addBody=a.addBody.bind(Object(k.a)(a)),a.updateBody=a.updateBody.bind(Object(k.a)(a)),a.deleteBody=a.deleteBody.bind(Object(k.a)(a)),a}return Object(j.a)(t,e),Object(g.a)(t,[{key:"checkRule",value:function(e,t){var a;if("path"===e)a=t.startsWith("/")?{status:"success",help:""}:{status:"error",help:"path\u9700\u8981\u4ee5/\u5f00\u5934"},this.setState({pathHelp:a});else if("headers"===e){var n={status:"success",help:""},l=!0,r=!1,s=void 0;try{for(var u,i=t[Symbol.iterator]();!(l=(u=i.next()).done);l=!0){u.value.key||(n={status:"error",help:"HTTP\u5934Key\u4e0d\u80fd\u4e3a\u7a7a"})}}catch(o){r=!0,s=o}finally{try{l||null==i.return||i.return()}finally{if(r)throw s}}this.setState({headersHelp:n})}}},{key:"changeInputValue",value:function(e){this.checkRule(e.target.name,e.target.value),this.props.updateHandler(this.props.rule.index,e.target.name,e.target.value)}},{key:"changeInputValueByName",value:function(e,t){this.checkRule(e,t),this.props.updateHandler(this.props.rule.index,e,t)}},{key:"addHeader",value:function(){var e=I()(this.props.rule.headers,{$push:[new $]});this.changeInputValueByName("headers",e)}},{key:"updateHeader",value:function(e,t,a){var n=K(this.props.rule.headers,e);if(n>=0){var l=I()(this.props.rule.headers,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.changeInputValueByName("headers",l)}}},{key:"deleteHeader",value:function(e){var t=K(this.props.rule.headers,e);if(t>=0){var a=I()(this.props.rule.headers,{$splice:[[t,1]]});this.changeInputValueByName("headers",a)}}},{key:"addBody",value:function(){var e=I()(this.props.rule.requestBody,{$push:[new G]});this.changeInputValueByName("requestBody",e)}},{key:"updateBody",value:function(e,t,a){var n=K(this.props.rule.requestBody,e);if(n>=0){var l=I()(this.props.rule.requestBody,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.changeInputValueByName("requestBody",l)}}},{key:"deleteBody",value:function(e){var t=K(this.props.rule.requestBody,e);if(t>=0){var a=I()(this.props.rule.requestBody,{$splice:[[t,1]]});this.changeInputValueByName("requestBody",a)}}},{key:"setIdentificationName",value:function(e){this.props.rule.setIdenKey(e)}},{key:"render",value:function(){var e=this;return l.a.createElement(q.a,{title:l.a.createElement("div",null,"\u89c4\u5219\uff08Rule\uff09",l.a.createElement(o.a,{defaultValue:this.props.rule.detct,style:{width:120},name:"detct",onChange:function(t){return e.changeInputValueByName("detct",t)}},["and","or"].map(function(e,t){return l.a.createElement(o.a.Option,{value:e,key:e},e)}))),size:"small",className:"rule-card",style:{marginBottom:"24px"},extra:l.a.createElement(i.a.Group,{size:"small"},l.a.createElement(i.a,{onClick:function(t){return e.props.deleteHandler(e.props.rule.index)},disabled:this.props.ruleSize<=1},"\u5220\u9664Rule"),l.a.createElement(i.a,{onClick:this.props.addHandler},"\u589e\u52a0\u4e00\u4e2aRule"))},l.a.createElement(c.a,null,l.a.createElement(d.a,{span:4},l.a.createElement(h.a.Item,{label:"\u8bf7\u6c42\u65b9\u6cd5",className:"rule-item"},l.a.createElement(o.a,{defaultValue:this.props.rule.method,style:{width:120},name:"method",onChange:function(t){return e.changeInputValueByName("method",t)}},["GET","POST","PUT"].map(function(e,t){return l.a.createElement(o.a.Option,{value:e,key:e},e)})))),l.a.createElement(d.a,{span:20},l.a.createElement(h.a.Item,{label:"\u8bf7\u6c42\u8def\u5f84",className:"rule-item",validateStatus:this.state.pathHelp.status,help:this.state.pathHelp.help},l.a.createElement(p.a,{placeholder:"/path/to/request",type:"text",name:"path",value:this.props.rule.path,onChange:this.changeInputValue})))),l.a.createElement(h.a.Item,{label:"\u8bf7\u6c42\u5934",className:"rule-item",validateStatus:this.state.headersHelp.status,help:this.state.headersHelp.help},this.props.rule.headers.map(function(t,a){return l.a.createElement(T,{key:t.index,header:t,showAddButton:a===e.props.rule.headers.length-1,showDeleteButton:e.props.rule.headers.length>1,addHandler:e.addHeader,updateHandler:e.updateHeader,deleteHandler:e.deleteHeader})})),l.a.createElement(h.a.Item,{label:"\u8bf7\u6c42\u4f53",className:"rule-item",validateStatus:this.state.bodysHelp.status,help:this.state.bodysHelp.help},this.props.rule.requestBody.map(function(t,a){return l.a.createElement(z,{key:t.index,body:t,showAddButton:a===e.props.rule.requestBody.length-1,showDeleteButton:e.props.rule.requestBody.length>1,addHandler:e.addBody,updateHandler:e.updateBody,deleteHandler:e.deleteBody})})),l.a.createElement(h.a.Item,{label:"\u662f\u5426302\u8df3\u8f6c",className:"rule-item"},l.a.createElement(R.a,{checked:this.props.rule.follow_redirects,name:"follow_redirects",onChange:function(t){return e.changeInputValueByName("follow_redirects",t)}})),l.a.createElement(c.a,null,l.a.createElement(d.a,{span:6},l.a.createElement(h.a.Item,{label:"\u63d0\u53d6\u76ee\u6807",className:"rule-item"},l.a.createElement(o.a,{defaultValue:"",style:{width:120},name:"idenName",onChange:function(t){return e.setIdentificationName(t)}},["header","body","iconmd5","statuscode"].map(function(e,t){return l.a.createElement(o.a.Option,{value:e,key:e},e)})))),l.a.createElement(d.a,{span:18},l.a.createElement(h.a.Item,{label:"\u63d0\u53d6\u89c4\u5219",className:"rule-item"},l.a.createElement(p.a,{placeholder:"asd",type:"text",value:this.state.idenValue,onChange:this.setIdentificationValue})))))}}]),t}(l.a.Component),F=0,Y=function(){function e(){Object(b.a)(this,e),this.index=++F,this.method="GET",this.detct="or",this.path="",this.headers=[new $],this.requestBody=[new G],this.follow_redirects=!0,this.identification={}}return Object(g.a)(e,[{key:"setIdenKey",value:function(e){this.identification=Object(f.a)({},e,Object.values(this.identification)[0])}},{key:"setIdenValue",value:function(e){this.identification=Object(f.a)({},Object.keys(this.identification)[0],e)}}]),e}(),_=w.a.Header,M=w.a.Content,J=w.a.Footer,U=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).state={name:"finger-yaml-",version:"v",confidence:100,detection:"header",word:"",rules:[new Y],detail:{},poc:""},a.updateRule=a.updateRule.bind(Object(k.a)(a)),a.generatePOC=a.generatePOC.bind(Object(k.a)(a)),a.addRule=a.addRule.bind(Object(k.a)(a)),a.deleteRule=a.deleteRule.bind(Object(k.a)(a)),a.notify=a.notify.bind(Object(k.a)(a)),a}return Object(j.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;new S.a("#copy-btn").on("success",function(t){e.notify("\u590d\u5236\u6210\u529f","\u6307\u7eb9Yaml\u5185\u5bb9\u5df2\u6210\u529f\u590d\u5236\u5230\u526a\u5207\u677f")})}},{key:"notify",value:function(e,t){v.a.success({message:e,description:t,duration:3})}},{key:"updateRule",value:function(e,t,a){var n=K(this.state.rules,e);if(n>=0){var l=I()(this.state.rules,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.setState({rules:l})}}},{key:"deleteRule",value:function(e){var t=K(this.state.rules,e);if(t>=0){var a=I()(this.state.rules,{$splice:[[t,1]]});this.setState({rules:a})}}},{key:"generatePOC",value:function(){for(var e=[],t=[],a=0;a<this.state.rules.length;a++)"or"==this.state.rules[a].detct?e.push(this.state.rules[a]):t.push(this.state.rules[a]);var n={name:this.state.name,version:String(this.state.version),confidence:this.state.confidence,default:{detection:this.state.detection,word:this.state.word},rulesOr:C()(e),rulesAnd:C()(t)},l=!0,r=!1,s=void 0;try{for(var u,i=n.rulesOr[Symbol.iterator]();!(l=(u=i.next()).done);l=!0){var o=u.value;delete o.index;var c={},d=!0,h=!1,p=void 0;try{for(var m,y=o.headers[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var f=m.value;f.key&&(c[f.key]=f.value)}}catch(U){h=!0,p=U}finally{try{d||null==y.return||y.return()}finally{if(h)throw p}}Object.keys(c).length>0?o.headers=c:delete o.headers;var v={},b=!0,g=!1,E=void 0;try{for(var O,k=o.requestBody[Symbol.iterator]();!(b=(O=k.next()).done);b=!0){var j=O.value;j.key&&(v[j.key]=j.value)}}catch(U){g=!0,E=U}finally{try{b||null==k.return||k.return()}finally{if(g)throw E}}Object.keys(v).length>0?o.requestBody=v:delete o.requestBody,o.path.length||delete o.path}}catch(U){r=!0,s=U}finally{try{l||null==i.return||i.return()}finally{if(r)throw s}}var w=!0,B=!1,I=void 0;try{for(var H,V=n.rulesAnd[Symbol.iterator]();!(w=(H=V.next()).done);w=!0){var N=H.value;delete N.index;var S={},q=!0,R=!1,A=void 0;try{for(var T,z=N.headers[Symbol.iterator]();!(q=(T=z.next()).done);q=!0){var P=T.value;P.key&&(S[P.key]=P.value)}}catch(U){R=!0,A=U}finally{try{q||null==z.return||z.return()}finally{if(R)throw A}}Object.keys(S).length>0?N.headers=S:delete N.headers;var $={},D=!0,G=!1,K=void 0;try{for(var W,F=N.requestBody[Symbol.iterator]();!(D=(W=F.next()).done);D=!0){var Y=W.value;Y.key&&($[Y.key]=Y.value)}}catch(U){G=!0,K=U}finally{try{D||null==F.return||F.return()}finally{if(G)throw K}}Object.keys($).length>0?N.requestBody=$:delete N.requestBody,N.path.length||delete N.path}}catch(U){B=!0,I=U}finally{try{w||null==V.return||V.return()}finally{if(B)throw I}}var _=n.rulesOr.map(function(e){return e.hasOwnProperty("detct")&&delete e.detct,e}),M=n.rulesAnd.map(function(e){return e.hasOwnProperty("detct")&&delete e.detct,e});n.rulesOr=_,n.rulesAnd=M;var J=x.a.safeDump(n);this.setState({poc:J})}},{key:"addRule",value:function(){var e=I()(this.state.rules,{$push:[new Y]});this.setState({rules:e})}},{key:"render",value:function(){var e=this,t={labelCol:{span:4},wrapperCol:{span:8}};return l.a.createElement(w.a,{className:"layout"},l.a.createElement(_,null,l.a.createElement("div",{className:"logo"},l.a.createElement("span",{role:"img","aria-label":"dna","aria-hidden":"true"}),"FingerPrint-Yaml"),l.a.createElement(y.b,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["2"],style:{lineHeight:"64px"}})),l.a.createElement(M,{style:{padding:"0 50px"}},l.a.createElement(m.a,{style:{margin:"16px 0"}},l.a.createElement(m.a.Item,null,"\u9996\u9875"),l.a.createElement(m.a.Item,null,"\u6307\u7eb9Yaml\u751f\u6210")),l.a.createElement("div",{style:{background:"#fff",padding:24,minHeight:280}},l.a.createElement(c.a,{gutter:16,type:"flex"},l.a.createElement(d.a,{span:12},l.a.createElement(h.a,{layout:"horizontal",labelAlign:"left"},l.a.createElement(h.a.Item,Object.assign({label:"\u6307\u7eb9\u540d"},{labelCol:{span:2},wrapperCol:{span:22}}),l.a.createElement(p.a,{placeholder:"\u7531\u6570\u5b57\u3001\u5b57\u6bcd\u3001\u77ed\u6a2a\u7ebf\u7ec4\u6210",type:"text",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})}})),l.a.createElement(c.a,null,l.a.createElement(d.a,{span:12},l.a.createElement(h.a.Item,Object.assign({label:"\u7248\u672c"},t),l.a.createElement(p.a,{type:"text",value:this.state.version,onChange:function(t){return e.setState({version:t.target.value})}}))),l.a.createElement(d.a,{span:12},l.a.createElement(h.a.Item,Object.assign({label:"\u53ef\u4fe1\u5ea6"},t),l.a.createElement(p.a,{type:"text",value:this.state.confidence,onChange:function(t){return e.setState({confidence:t.target.value})}})))),l.a.createElement(c.a,null,l.a.createElement(d.a,{span:12},l.a.createElement(h.a.Item,Object.assign({label:"\u5173\u952e\u5b57"},t),l.a.createElement(o.a,{style:{width:120},name:"detection",defaultValue:"header"},["header","body"].map(function(e,t){return l.a.createElement(o.a.Option,{value:e,key:e},e)})))),l.a.createElement(d.a,{span:12},l.a.createElement(h.a.Item,Object.assign({label:"\u503c"},t),l.a.createElement(p.a,{type:"text",value:this.state.word,onChange:function(t){return e.setState({word:t.target.value})}})))),this.state.rules.map(function(t,a){return l.a.createElement(W,{key:t.index,rule:t,ruleSize:e.state.rules.length,updateHandler:e.updateRule,addHandler:e.addRule,deleteHandler:e.deleteRule})}))),l.a.createElement(d.a,{span:12,style:{paddingTop:"4px"}},l.a.createElement(u.a,{offsetTop:8},l.a.createElement(p.a.TextArea,{autosize:{minRows:20},placeholder:"\u751f\u6210\u6307\u7eb9Yaml\u5185\u5bb9",value:this.state.poc,id:"poc-detail",readOnly:!0,style:{marginBottom:"15px"}}),l.a.createElement(c.a,{justify:"end",type:"flex"},l.a.createElement(i.a,{type:"primary",size:"default",onClick:this.generatePOC,className:"br"},"\u751f\u6210"),l.a.createElement(i.a,{type:"dashed",icon:"copy",id:"copy-btn","data-clipboard-text":this.state.poc},"\u590d\u5236\u6307\u7eb9"))))))),l.a.createElement(J,{style:{textAlign:"center"}}))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[188,1,2]]]);